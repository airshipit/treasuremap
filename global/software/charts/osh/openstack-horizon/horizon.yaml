---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: horizon
  labels:
    name: horizon-global
    component: horizon
  layeringDefinition:
    abstract: false
    layer: global
  storagePolicy: cleartext
  substitutions:
    # Chart source
    - src:
        schema: pegleg/SoftwareVersions/v1
        name: software-versions
        path: .charts.osh.horizon
      dest:
        path: .source

    # Images
    - src:
        schema: pegleg/SoftwareVersions/v1
        name: software-versions
        path: .images.osh.horizon
      dest:
        path: .values.images.tags
    - src:
        schema: pegleg/CommonAddresses/v1
        name: common-addresses
        path: .dns.ingress_domain
      dest:
        - path: .values.conf.horizon.local_settings.config.allowed_hosts[0]
          pattern: DOMAIN

    # Endpoints
    - src:
        schema: pegleg/EndpointCatalogue/v1
        name: osh_endpoints
        path: .osh.identity
      dest:
        path: .values.endpoints.identity
    - src:
        schema: pegleg/EndpointCatalogue/v1
        name: osh_endpoints
        path: .osh.dashboard
      dest:
        path: .values.endpoints.dashboard
    - src:
        schema: pegleg/EndpointCatalogue/v1
        name: osh_endpoints
        path: .osh.oslo_db
      dest:
        path: .values.endpoints.oslo_db
    - src:
        schema: pegleg/EndpointCatalogue/v1
        name: osh_endpoints
        path: .osh.oslo_cache
      dest:
        path: .values.endpoints.oslo_cache

    # Service Accounts
    - src:
        schema: pegleg/AccountCatalogue/v1
        name: osh_service_accounts
        path: .osh.horizon.admin
      dest:
        path: .values.endpoints.identity.auth.admin
    - src:
        schema: pegleg/AccountCatalogue/v1
        name: osh_service_accounts
        path: .osh.horizon.oslo_db
      dest:
        path: .values.endpoints.oslo_db.auth.horizon
    - src:
        schema: pegleg/AccountCatalogue/v1
        name: osh_service_accounts
        path: .osh.horizon.oslo_db.database
      dest:
        path: .values.endpoints.oslo_db.path
        pattern: DB_NAME

    # Secrets
    - dest:
        path: .values.endpoints.oslo_db.auth.horizon.password
      src:
        schema: deckhand/Passphrase/v1
        name: osh_horizon_oslo_db_password
        path: .
    - dest:
        path: .values.endpoints.oslo_db.auth.admin.password
      src:
        schema: deckhand/Passphrase/v1
        name: osh_oslo_db_admin_password
        path: .
    - dest:
        path: .values.endpoints.oslo_cache.auth.memcache_secret_key
      src:
        schema: deckhand/Passphrase/v1
        name: osh_oslo_cache_secret_key
        path: .
    - dest:
        path: .values.conf.horizon.local_settings.config.horizon_secret_key
      src:
        schema: deckhand/Passphrase/v1
        name: osh_horizon_secret_key
        path: .
    - dest:
        path: .values.endpoints.identity.auth.admin.password
      src:
        schema: deckhand/Passphrase/v1
        name: osh_keystone_admin_password
        path: .
data:
  chart_name: horizon
  release: horizon
  namespace: openstack
  install:
    no_hooks: false
  wait:
    timeout: 900
    labels:
      release_group: clcp-horizon
    resources:
      - type: job
      - type: deployment
        min_ready: 100%
    native:
      enabled: false
  upgrade:
    no_hooks: false
    pre:
      delete:
        - type: job
          labels:
            release_group: clcp-horizon
    post:
      create: []
  values:
    labels:
      node_selector_key: openstack-control-plane
      node_selector_value: enabled
    pod:
      replicas:
        server: 3
      affinity:
        anti:
          type:
            server: requiredDuringSchedulingIgnoredDuringExecution
    conf:
      software:
        apache2:
          site_dir: /etc/apache2/sites-available
          conf_dir: /etc/apache2/conf-available
          mods_dir: /etc/apache2/mods-available
      horizon:
        local_settings:
          config:
            secure_proxy_ssl_header: true
            csrf_cookie_secure: "True"
            session_cookie_secure: "True"
            session_cookie_httponly: "True"
            disable_password_reveal: "True"
            disallow_iframe_embed: "True"
            log_level: "INFO"
            allowed_hosts:
              - .DOMAIN
              - '.att.com'
              - '.cluster.local'
            horizon_images_upload_mode: 'off'
        policy:
          cinder:
            'context_is_admin': 'role:admin or role:admin_support or role:admin_viewer'
            'admin_create': 'role:admin or role:admin_support'
            'admin_read': 'role:admin or role:admin_support or role:admin_viewer'
            'admin_update': 'role:admin'
            'admin_delete': 'role:admin'
            'tenant_create': 'role:snapshot_member or role:_member_ or role:sriov_member or role:support_member or rule:admin_create'
            'tenant_snapshot_create': 'role:snapshot_member or rule:admin_update'
            'tenant_read': 'role:snapshot_member or role:_member_ or role:sriov_member or role:support_member or role:viewer or rule:admin_read'
            'tenant_update': 'role:snapshot_member or role:_member_ or role:sriov_member or rule:admin_update'
            'tenant_delete': 'role:snapshot_member or role:_member_ or role:sriov_member or rule:admin_delete'
            'not_supported_in_nc': '!'
            'volume:attachment_create': 'rule:tenant_create or role:tenant_cinder_create'
            'volume:attachment_update': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:attachment_delete': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:attachment_complete': 'rule:tenant_create or role:tenant_cinder_create'
            'volume:multiattach_bootable_volume': 'rule:tenant_create or role:tenant_cinder_create'
            'message:get_all': 'rule:tenant_read or role:tenant_cinder_read or role:admin_cinder_read'
            'message:get': 'rule:tenant_read or role:tenant_cinder_read or role:admin_cinder_read'
            'message:delete': 'rule:tenant_delete or role:tenant_cinder_delete or role:admin_cinder_delete'
            'clusters:get_all': 'rule:admin_read or role:admin_cinder_read'
            'clusters:get': 'rule:admin_read or role:admin_cinder_read'
            'clusters:update': 'rule:admin_update or role:admin_cinder_update'
            'workers:cleanup': 'rule:admin_update or role:admin_cinder_update'
            'volume:get_snapshot_metadata': 'rule:tenant_read or role:tenant_cinder_read'
            'volume:update_snapshot_metadata': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:delete_snapshot_metadata': 'rule:tenant_delete or role:tenant_cinder_delete'
            'volume:get_all_snapshots': 'rule:tenant_read or role:tenant_cinder_read'
            'volume_extension:extended_snapshot_attributes': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:create_snapshot': 'rule:tenant_create or role:tenant_cinder_create'
            'volume:get_snapshot': 'rule:tenant_read or role:tenant_cinder_read'
            'volume:update_snapshot': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:delete_snapshot': 'rule:tenant_delete or role:tenant_cinder_delete'
            'volume_extension:snapshot_admin_actions:reset_status': 'rule:admin_update or role:admin_cinder_update'
            'snapshot_extension:snapshot_actions:update_snapshot_status': 'rule:tenant_update or role:tenant_cinder_update or role:admin_cinder_update'
            'volume_extension:snapshot_admin_actions:force_delete': 'rule:admin_delete or role:admin_cinder_delete'
            'snapshot_extension:list_manageable': 'rule:not_supported_in_nc'
            'snapshot_extension:snapshot_manage': 'rule:not_supported_in_nc'
            'snapshot_extension:snapshot_unmanage': 'rule:not_supported_in_nc'
            'backup:get_all': 'rule:tenant_read or role:tenant_cinder_read'
            'backup:backup_project_attribute': 'rule:admin_update or role:admin_cinder_update'
            'backup:create': 'rule:tenant_create or role:tenant_cinder_create'
            'backup:get': 'rule:tenant_read or role:tenant_cinder_read'
            'backup:update': 'rule:tenant_update or role:tenant_cinder_update or role:admin_cinder_update'
            'backup:delete': 'rule:tenant_delete or role:tenant_cinder_delete'
            'backup:restore': 'rule:tenant_update or role:tenant_cinder_update'
            'backup:backup-import': 'rule:admin_update or role:admin_cinder_update'
            'backup:export-import': 'rule:admin_create or role:admin_cinder_create or role:tenant_cinder_create'
            'volume_extension:backup_admin_actions:reset_status': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:backup_admin_actions:force_delete': 'rule:admin_delete or role:admin_cinder_delete'
            'group:get_all': 'rule:tenant_read or role:tenant_cinder_read or role:admin_cinder_read'
            'group:create': 'rule:tenant_create or role:tenant_cinder_create or role:admin_cinder_create'
            'group:get': 'rule:tenant_read or role:tenant_cinder_read or role:admin_cinder_read'
            'group:update': 'rule:tenant_update or role:tenant_cinder_update or role:admin_cinder_update'
            'group:group_project_attribute': 'rule:tenant_read or role:tenant_cinder_read or role:admin_cinder_read'
            'group:group_types_manage': 'rule:admin_read or role:admin_cinder_read or role:admin_cinder_update'
            'group:access_group_types_specs': 'rule:admin_read or role:admin_cinder_read'
            'group:group_types_specs': 'rule:admin_create or role:admin_cinder_create'
            'group:get_all_group_snapshots': 'rule:tenant_read or role:tenant_cinder_read or role:admin_cinder_read'
            'group:create_group_snapshot': 'rule:tenant_create or role:tenant_cinder_create or role:admin_cinder_create'
            'group:get_group_snapshot': 'rule:tenant_read or role:tenant_cinder_read or role:admin_cinder_read'
            'group:delete_group_snapshot': 'rule:tenant_delete or role:tenant_cinder_delete or role:admin_cinder_delete'
            'group:update_group_snapshot': 'rule:tenant_update or role:tenant_cinder_update or role:admin_cinder_update'
            'group:group_snapshot_project_attribute': 'rule:tenant_read or role:tenant_cinder_read or role:admin_cinder_read'
            'group:reset_group_snapshot_status': 'rule:admin_update or role:admin_cinder_update'
            'group:delete': 'rule:tenant_delete or role:tenant_cinder_delete or role:admin_cinder_delete'
            'group:reset_status': 'rule:admin_update or role:admin_cinder_update'
            'group:enable_replication': 'rule:admin_update or role:admin_cinder_update'
            'group:disable_replication': 'rule:admin_update or role:admin_cinder_update'
            'group:failover_replication': 'rule:admin_update or role:admin_cinder_update'
            'group:list_replication_targets': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:qos_specs_manage:get_all': 'rule:admin_read or role:admin_cinder_read'
            'volume_extension:qos_specs_manage:get': 'rule:admin_read or role:admin_cinder_read'
            'volume_extension:qos_specs_manage:create': 'rule:admin_create or role:admin_cinder_create'
            'volume_extension:qos_specs_manage:update': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:qos_specs_manage:delete': 'rule:admin_delete or role:admin_cinder_delete'
            'volume_extension:quota_classes': 'rule:admin_read or role:admin_cinder_read'
            'volume_extension:quotas:show': 'rule:tenant_read or role:tenant_cinder_read'
            'volume_extension:quotas:update': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:quotas:delete': 'rule:admin_delete or role:admin_cinder_delete'
            'volume_extension:quota_classes:validate_setup_for_nested_quota_use': 'rule:admin_read or role:admin_cinder_read'
            'volume_extension:capabilities': 'rule:admin_read or role:admin_cinder_read'
            'volume_extension:services:index': 'rule:admin_read or role:admin_cinder_read'
            'volume_extension:services:update': 'rule:admin_update or role:admin_cinder_update'
            'volume:freeze_host': 'rule:admin_update or role:admin_cinder_update'
            'volume:thaw_host': 'rule:admin_update or role:admin_cinder_update'
            'volume:failover_host': 'rule:admin_update or role:admin_cinder_update'
            'scheduler_extension:scheduler_stats:get_pools': 'rule:admin_read or role:admin_cinder_read'
            'volume_extension:hosts': 'rule:context_is_admin or role:admin_cinder_create or role:admin_cinder_update or role:admin_cinder_read or role:admin_cinder_delete'
            'limits_extension:used_limits': 'rule:tenant_read or role:tenant_cinder_read or role:admin_cinder_read'
            'volume_extension:list_manageable': 'rule:not_supported_in_nc'
            'volume_extension:volume_manage': 'rule:not_supported_in_nc'
            'volume_extension:volume_unmanage': 'rule:not_supported_in_nc'
            'volume_extension:types_manage': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:type_get': 'rule:tenant_read or role:tenant_cinder_read'
            'volume_extension:type_get_all': 'rule:tenant_read or role:tenant_cinder_read'
            'volume_extension:volume_type_encryption:create': 'rule:admin_create or role:admin_cinder_create'
            'volume_extension:volume_type_encryption:get': 'rule:admin_read or role:admin_cinder_read'
            'volume_extension:volume_type_encryption:update': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:volume_type_encryption:delete': 'rule:admin_delete or role:admin_cinder_delete'
            'volume_extension:access_types_extra_specs': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:access_types_qos_specs_id': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:volume_type_access': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:volume_type_access:addProjectAccess': 'rule:admin_create or role:admin_cinder_create'
            'volume_extension:volume_type_access:removeProjectAccess': 'rule:admin_delete or role:admin_cinder_delete'
            'volume:extend': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:extend_attached_volume': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:revert_to_snapshot': 'rule:tenant_update or role:tenant_cinder_update'
            'volume_extension:volume_admin_actions:reset_status': 'rule:admin_update or role:admin_cinder_update'
            'volume:retype': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:update_readonly_flag': 'rule:tenant_update or role:tenant_cinder_update'
            'volume_extension:volume_admin_actions:force_delete': 'rule:admin_delete or role:admin_cinder_delete'
            'volume_extension:volume_actions:upload_public': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:volume_actions:upload_image': 'rule:tenant_snapshot_create or role:admin_cinder_update'
            'volume_extension:volume_admin_actions:force_detach': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:volume_admin_actions:migrate_volume': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:volume_admin_actions:migrate_volume_completion': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:volume_actions:initialize_connection': 'rule:tenant_create or role:tenant_cinder_create'
            'volume_extension:volume_actions:terminate_connection': 'rule:tenant_update or role:tenant_cinder_update'
            'volume_extension:volume_actions:roll_detaching': 'rule:tenant_update or role:tenant_cinder_update'
            'volume_extension:volume_actions:reserve': 'rule:tenant_update or role:tenant_cinder_update'
            'volume_extension:volume_actions:unreserve': 'rule:tenant_update or role:tenant_cinder_update'
            'volume_extension:volume_actions:begin_detaching': 'rule:tenant_update or role:tenant_cinder_update'
            'volume_extension:volume_actions:attach': 'rule:tenant_create or role:tenant_cinder_create'
            'volume_extension:volume_actions:detach': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:get_all_transfers': 'rule:tenant_read or role:tenant_cinder_read'
            'volume:create_transfer': 'rule:tenant_create or role:tenant_cinder_create'
            'volume:get_transfer': 'rule:tenant_read or role:tenant_cinder_read'
            'volume:accept_transfer': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:delete_transfer': 'rule:tenant_delete or role:tenant_cinder_delete'
            'volume:get_volume_metadata': 'rule:tenant_read or role:tenant_cinder_read'
            'volume:create_volume_metadata': 'rule:tenant_create or role:tenant_cinder_create'
            'volume:update_volume_metadata': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:delete_volume_metadata': 'rule:tenant_delete or role:tenant_cinder_delete'
            'volume_extension:volume_image_metadata': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:update_volume_admin_metadata': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:types_extra_specs:index': 'rule:admin_read or role:admin_cinder_read'
            'volume_extension:types_extra_specs:create': 'rule:admin_create or role:admin_cinder_create'
            'volume_extension:types_extra_specs:show': 'rule:admin_read or role:admin_cinder_read'
            'volume_extension:types_extra_specs:update': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:types_extra_specs:delete': 'rule:admin_delete or role:admin_cinder_delete'
            'volume:create': 'rule:tenant_create or role:tenant_cinder_create'
            'volume:create_from_image': 'rule:tenant_create or role:tenant_cinder_create'
            'volume:get': 'rule:tenant_read or role:tenant_cinder_read'
            'volume:get_all': 'rule:tenant_read or role:tenant_cinder_read'
            'volume:update': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:delete': 'rule:tenant_delete or role:tenant_cinder_delete'
            'volume:force_delete': 'rule:admin_delete or role:admin_cinder_delete'
            'volume_extension:volume_host_attribute': 'rule:context_is_admin or role:admin_cinder_create or role:admin_cinder_update or role:admin_cinder_read or role:admin_cinder_delete'
            'volume_extension:volume_tenant_attribute': 'rule:tenant_update or role:tenant_cinder_update or rule:context_is_admin or role:admin_cinder_create or role:admin_cinder_update or role:admin_cinder_read or role:admin_cinder_delete'
            'volume_extension:volume_mig_status_attribute': 'rule:admin_update or role:admin_cinder_update'
            'volume_extension:volume_encryption_metadata': 'rule:tenant_update or role:tenant_cinder_update'
            'volume:multiattach': 'rule:tenant_create or role:tenant_cinder_create'

          glance:
            'context_is_admin': 'role:admin or role:admin_support or role:admin_viewer'
            'default': 'role:admin'
            'admin_create': 'role:admin or role:admin_support'
            'admin_read': 'role:admin or role:admin_support or role:admin_viewer'
            'admin_update': 'role:admin'
            'admin_delete': 'role:admin'
            'admin_snapshot': 'role:admin'
            'tenant_create': 'role:snapshot_member or role:_member_ or role:sriov_member or role:support_member or rule:admin_create'
            'tenant_snapshot_create': 'role:snapshot_member or rule:admin_create'
            'tenant_snapshot_delete': 'role:snapshot_member or rule:admin_delete'
            'tenant_read': 'role:snapshot_member or role:_member_  or role:sriov_member or role:support_member or role:viewer or rule:admin_read'
            'tenant_update': 'role:snapshot_member or role:_member_ or role:sriov_member or rule:admin_update'
            'tenant_delete': 'role:snapshot_member or role:_member_ or role:sriov_member or rule:admin_delete'
            'tenant_modify_action': 'role:_member_ or role:sriov_member or rule:tenant_snapshot_create'
            'admin_or_owner': 'role:admin or project_id:%(project_id)s'
            'add_image': 'rule:tenant_snapshot_create or role:tenant_glance_create'
            'delete_image': 'rule:tenant_snapshot_delete or role:tenant_glance_delete'
            'get_image': 'rule:tenant_read or role:tenant_glance_read'
            'get_images': 'rule:tenant_read or role:tenant_glance_read'
            'modify_image': 'rule:tenant_snapshot_create or role:tenant_glance_create'
            'publicize_image': 'rule:admin_create or role:admin_glance_create'
            'communitize_image': 'rule:admin_create or role:admin_glance_create'
            'copy_from': 'rule:admin_create or role:admin_glance_create'
            'download_image': 'rule:tenant_create or role:tenant_glance_create'
            'upload_image': 'rule:tenant_snapshot_create or role:tenant_glance_create'
            'delete_image_location': 'rule:admin_delete or role:admin_glance_delete'
            'get_image_location': 'rule:tenant_create or role:tenant_glance_create'
            'set_image_location': 'rule:admin_create or role:admin_glance_create'
            'add_member': 'rule:tenant_create or role:tenant_glance_create'
            'delete_member': 'rule:tenant_update or role:tenant_glance_update'
            'get_member': 'rule:tenant_read or role:tenant_glance_read'
            'get_members': 'rule:tenant_read or role:tenant_glance_read'
            'modify_member': 'rule:tenant_create or role:tenant_glance_create'
            'manage_image_cache': 'rule:admin_update or role:admin_glance_update'
            'get_task': 'rule:tenant_read or role:tenant_glance_read'
            'get_tasks': 'rule:tenant_read or role:tenant_glance_read'
            'add_task': 'rule:admin_create or role:admin_glance_create'
            'modify_task': 'rule:admin_create or role:admin_glance_create'
            'tasks_api_access': 'role:admin'
            'deactivate': 'rule:admin_update or role:admin_glance_update'
            'reactivate': 'rule:admin_update or role:admin_glance_update'
            'get_metadef_namespace': 'rule:tenant_read or role:tenant_glance_read'
            'get_metadef_namespaces': 'rule:tenant_read or role:tenant_glance_read'
            'modify_metadef_namespace': 'rule:tenant_modify_action or role:tenant_glance_update'
            'add_metadef_namespace': 'rule:tenant_create or role:tenant_glance_create'
            'delete_metadef_namespace': 'rule:tenant_delete or role:tenant_glance_delete'
            'get_metadef_object': 'rule:tenant_read or role:tenant_glance_read'
            'get_metadef_objects': 'rule:tenant_read or role:tenant_glance_read'
            'modify_metadef_object': 'rule:tenant_modify_action or role:tenant_glance_update'
            'add_metadef_object': 'rule:tenant_create or role:tenant_glance_create'
            'delete_metadef_object': 'rule:tenant_delete or role:tenant_glance_delete'
            'list_metadef_resource_types': 'rule:tenant_read or role:tenant_glance_read'
            'get_metadef_resource_type': 'rule:tenant_read or role:tenant_glance_read'
            'add_metadef_resource_type_association': 'rule:tenant_create or role:tenant_glance_create'
            'delete_metadef_resource_type_association': 'rule:tenant_delete or role:tenant_glance_delete'
            'get_metadef_property': 'rule:tenant_read or role:tenant_glance_read'
            'get_metadef_properties': 'rule:tenant_read or role:tenant_glance_read'
            'modify_metadef_property': 'rule:tenant_modify_action or role:tenant_glance_update'
            'add_metadef_property': 'rule:tenant_create or role:tenant_glance_create'
            'delete_metadef_property': 'rule:tenant_delete or role:tenant_glance_delete'
            'get_metadef_tag': 'rule:tenant_read or role:tenant_glance_create'
            'get_metadef_tags': 'rule:tenant_read or role:tenant_glance_create'
            'modify_metadef_tag': 'rule:tenant_modify_action or role:tenant_glance_update'
            'add_metadef_tag': 'rule:tenant_create or role:tenant_glance_create'
            'add_metadef_tags': 'rule:tenant_create or role:tenant_glance_create'
            'delete_metadef_tag': 'rule:tenant_delete or role:tenant_glance_delete'
            'delete_metadef_tags': 'rule:tenant_delete or role:tenant_glance_delete'

          heat:
            'deny_stack_user': 'not role:heat_stack_user'
            'default': 'role:admin'
            'context_is_admin': 'role:admin or role:admin_support or role:admin_viewer'
            'tenant_create': 'role:_member_ or role:sriov_member or role:snapshot_member or role:support_member or role:admin or role:admin_support'
            'tenant_read': 'role:_member_ or role:sriov_member or role:snapshot_member or role:support_member or role:viewer or role:admin or role:admin_support or role:admin_viewer'
            'tenant_update': 'role:_member_ or role:sriov_member or role:snapshot_member or role:admin'
            'tenant_delete': 'role:_member_ or role:sriov_member or role:snapshot_member or role:admin'
            'tenant_snapshot': 'role:snapshot_member or role:admin'
            'actions:action': 'rule:tenant_update or role:tenant_heat_update'
            'build_info:build_info': 'rule:tenant_read or role:tenant_heat_read'
            'events:index': 'rule:tenant_read or role:tenant_heat_read'
            'events:show': 'rule:tenant_read or role:tenant_heat_read'
            'resource:index': 'rule:tenant_read or role:tenant_heat_read'
            'resource:metadata': 'rule:tenant_create or role:tenant_heat_create'
            'resource:signal': 'rule:tenant_create or role:tenant_heat_create or role:heat_stack_user'
            'resource:mark_unhealthy': 'rule:tenant_create or role:tenant_heat_create'
            'resource:show': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:abandon': 'rule:tenant_delete or role:tenant_heat_delete'
            'stacks:create': 'rule:tenant_create or role:tenant_heat_create'
            'stacks:delete': 'rule:tenant_delete or role:tenant_heat_delete'
            'stacks:detail': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:export': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:files': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:generate_template': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:global_index': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:index': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:list_resource_types': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:list_template_versions': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:list_template_functions': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:lookup': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:preview': 'rule:tenant_create or role:tenant_heat_create'
            'stacks:resource_schema': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:show': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:template': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:environment': 'rule:tenant_read or role:tenant_heat_read'
            'stacks:update': 'rule:tenant_update or role:tenant_heat_update'
            'stacks:update_patch': 'rule:tenant_update or role:tenant_heat_update'
            'stacks:preview_update': 'rule:tenant_update or role:tenant_heat_update'
            'stacks:preview_update_patch': 'rule:tenant_update or role:tenant_heat_update'
            'stacks:validate_template': 'rule:tenant_create or role:tenant_heat_create'
            'stacks:snapshot': 'rule:tenant_snapshot or role:tenant_heat_create'
            'stacks:show_snapshot': 'rule:tenant_snapshot or role:tenant_heat_read'
            'stacks:delete_snapshot': 'rule:tenant_snapshot or role:tenant_heat_delete'
            'stacks:list_snapshots': 'rule:tenant_snapshot or role:tenant_heat_read'
            'stacks:restore_snapshot': 'rule:tenant_snapshot or role:tenant_heat_create'
            'stacks:list_outputs': 'rule:tenant_snapshot or role:tenant_heat_read'
            'stacks:show_output': 'rule:tenant_snapshot or role:tenant_heat_read'
            'software_configs:global_index': 'rule:tenant_read or role:tenant_heat_read'
            'software_configs:index': 'rule:tenant_read or role:tenant_heat_read'
            'software_configs:create': 'rule:tenant_create or role:tenant_heat_create'
            'software_configs:show': 'rule:tenant_read or role:tenant_heat_read'
            'software_configs:delete': 'rule:tenant_delete or role:tenant_heat_delete'
            'software_deployments:index': 'rule:tenant_read or role:tenant_heat_read'
            'software_deployments:create': 'rule:tenant_create or role:tenant_heat_create'
            'software_deployments:show': 'rule:tenant_read or role:tenant_heat_read'
            'software_deployments:update': 'rule:tenant_update or role:tenant_heat_update'
            'software_deployments:delete': 'rule:tenant_delete or role:tenant_heat_delete'
            'software_deployments:metadata': 'rule:tenant_read or role:tenant_heat_read'
            'service:index': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Blazar::Host': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Cinder::EncryptedVolumeType': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Cinder::QoSAssociation': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Cinder::QoSSpecs': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Cinder::Quota': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Cinder::VolumeType': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Keystone::*': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Manila::ShareType': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Neutron::ProviderNet': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Neutron::QoSBandwidthLimitRule': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Neutron::QoSPolicy': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Neutron::Quota': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Neutron::Segment': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Nova::Flavor': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Nova::HostAggregate': 'rule:tenant_read or role:tenant_heat_read'
            'resource_types:OS::Nova::Quota': 'rule:tenant_read or role:tenant_heat_read'
            'cloudformation:ListStacks': 'rule:deny_stack_user'
            'cloudformation:CreateStack': 'rule:deny_stack_user'
            'cloudformation:DescribeStacks': 'rule:deny_stack_user'
            'cloudformation:DeleteStack': 'rule:deny_stack_user'
            'cloudformation:UpdateStack': 'rule:deny_stack_user'
            'cloudformation:CancelUpdateStack': 'rule:deny_stack_user'
            'cloudformation:DescribeStackEvents': 'rule:deny_stack_user'
            'cloudformation:ValidateTemplate': 'rule:deny_stack_user'
            'cloudformation:GetTemplate': 'rule:deny_stack_user'
            'cloudformation:EstimateTemplateCost': 'rule:deny_stack_user'
            'cloudformation:DescribeStackResource': 'role:heat_stack_user'
            'cloudformation:DescribeStackResources': 'rule:deny_stack_user'
            'cloudformation:ListStackResources': 'rule:deny_stack_user'

          keystone:
            'context_is_admin': 'role:admin or is_admin:1 or role:admin_support or role:admin_viewer'
            'admin_required': 'role:admin or is_admin:1 or role:admin_orm or role:admin_support or role:admin_viewer'
            'admin_or_admin_orm': 'role:admin or role:admin_orm'
            'admin_only': 'role:admin'
            'admin_create': 'rule:admin_only or role:admin_support'
            'tenant_read': 'role:snapshot_member or role:_member_ or role:sriov_member or role:support_member or role:viewer or rule:admin_required'
            'service_role': 'role:service'
            'service_or_admin': 'rule:admin_required or rule:service_role'
            'owner': 'user_id:%(user_id)s'
            'admin_or_owner': 'rule:admin_required or rule:owner'
            'token_subject': 'user_id:%(target.token.user_id)s'
            'admin_or_token_subject': 'rule:admin_required or rule:token_subject'
            'service_admin_or_token_subject': 'rule:service_or_admin or rule:token_subject'
            'default': 'rule:admin_required'
            'identity:get_region': 'rule:tenant_read or role:tenant_keystone_read'
            'identity:list_regions': 'rule:tenant_read or role:tenant_keystone_read'
            'identity:create_region': 'rule:admin_only or role:admin_keystone_create'
            'identity:update_region': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_region': 'rule:admin_only or role:admin_keystone_delete'
            'identity:get_service': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_services': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_service': 'rule:admin_only or role:admin_keystone_create'
            'identity:update_service': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_service': 'rule:admin_only or role:admin_keystone_delete'
            'identity:get_endpoint': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_endpoints': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_endpoint': 'rule:admin_only or role:admin_keystone_create'
            'identity:update_endpoint': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_endpoint': 'rule:admin_only or role:admin_keystone_delete'
            'identity:get_domain': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_domains': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_domain': 'rule:admin_only or role:admin_keystone_create'
            'identity:update_domain': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_domain': 'rule:admin_only or role:admin_keystone_delete'
            'identity:get_project': 'rule:admin_required or project_id:%(target.project.id)s or role:admin_keystone_read'
            'identity:list_projects': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_all_projects': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_user_projects': 'rule:admin_or_owner or role:admin_keystone_read'
            'identity:create_project': 'rule:admin_or_admin_orm or rule:admin_create or role:admin_keystone_create'
            'identity:update_project': 'rule:admin_or_admin_orm or rule:admin_create or role:admin_keystone_update or role:admin_keystone_create'
            'identity:delete_project': 'rule:admin_or_admin_orm or role:admin_keystone_delete'
            'identity:get_user': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_users': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_users': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_user': 'rule:admin_only or role:admin_keystone_create'
            'identity:update_user': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_user': 'rule:admin_only or role:admin_keystone_delete'
            'identity:change_password': 'rule:admin_only or rule:owner'
            'identity:get_group': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_groups': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_groups_for_user': 'rule:admin_or_owner or role:admin_keystone_read'
            'identity:create_group': 'rule:admin_create or role:admin_keystone_create'
            'identity:update_group': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_group': 'rule:admin_only or role:admin_keystone_delete'
            'identity:list_users_in_group': 'rule:admin_required or role:admin_keystone_read'
            'identity:remove_user_from_group': 'rule:admin_only or role:admin_keystone_update'
            'identity:check_user_in_group': 'rule:admin_required or role:admin_keystone_read'
            'identity:add_user_to_group': 'rule:admin_create or role:admin_keystone_create or role:admin_keystone_update'
            'identity:get_credential': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_credentials': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_credential': 'rule:admin_create or role:admin_keystone_create'
            'identity:update_credential': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_credential': 'rule:admin_only or role:admin_keystone_delete'
            'identity:ec2_get_credential': 'rule:admin_required or (rule:owner and user_id:%(target.credential.user_id)s) or role:admin_keystone_read'
            'identity:ec2_list_credentials': 'rule:admin_or_owner or role:admin_keystone_read'
            'identity:ec2_create_credential': 'rule:admin_create or role:admin_keystone_create'
            'identity:ec2_delete_credential': 'rule:admin_only or (rule:owner and user_id:%(target.credential.user_id)s) or role:admin_keystone_delete'
            'identity:get_role': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_roles': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_role': 'rule:admin_only or role:admin_keystone_create'
            'identity:update_role': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_role': 'rule:admin_only or role:admin_keystone_delete'
            'identity:get_domain_role': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_domain_roles': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_domain_role': 'rule:admin_create or role:admin_keystone_create'
            'identity:update_domain_role': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_domain_role': 'rule:admin_only or role:admin_keystone_delete'
            'identity:get_implied_role': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_implied_roles': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_implied_role': 'rule:admin_create or role:admin_keystone_create'
            'identity:delete_implied_role': 'rule:admin_only or role:admin_keystone_delete'
            'identity:list_role_inference_rules': 'rule:admin_required or role:admin_keystone_read'
            'identity:check_implied_role': 'rule:admin_required or role:admin_keystone_read'
            'identity:check_grant': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_grants': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_grant': 'rule:admin_create or role:admin_keystone_create'
            'identity:revoke_grant': 'rule:admin_create or role:adin_keystone_update'
            'identity:list_role_assignments': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_role_assignments_for_tree': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_policy': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_policies': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_policy': 'rule:admin_only or role:admin_keystone_create'
            'identity:update_policy': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_policy': 'rule:admin_only or role:admin_keystone_delete'
            'identity:check_token': 'rule:admin_or_token_subject or role:admin_keystone_read'
            'identity:validate_token': 'rule:service_admin_or_token_subject or role:admin_keystone_read'
            'identity:validate_token_head': 'rule:service_or_admin or role:admin_keystone_read'
            'identity:revocation_list': 'rule:service_or_admin or role:admin_keystone_read'
            'identity:revoke_token': 'rule:admin_or_token_subject or role:admin_keystone_update'
            'identity:endpoints': 'rule:service_or_admin or role:admin_keystone_read'
            'identity:create_trust': 'user_id:%(trust.trustor_user_id)s'
            'identity:list_trusts': ''
            'identity:list_roles_for_trust': ''
            'identity:get_role_for_trust': ''
            'identity:delete_trust': ''
            'identity:create_consumer': 'rule:admin_create or role:admin_keystone_create'
            'identity:get_consumer': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_consumers': 'rule:admin_required or role:admin_keystone_read'
            'identity:delete_consumer': 'rule:admin_only or role:admin_keystone_delete'
            'identity:update_consumer': 'rule:admin_only or role:admin_keystone_update'
            'identity:authorize_request_token': 'rule:admin_required or role:admin_keystone_create'
            'identity:list_access_token_roles': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_access_token_role': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_access_tokens': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_access_token': 'rule:admin_required or role:admin_keystone_read'
            'identity:delete_access_token': 'rule:admin_only or role:admin_keystone_delete'
            'identity:list_projects_for_endpoint': 'rule:admin_required or role:admin_keystone_read'
            'identity:add_endpoint_to_project': 'rule:admin_only or role:admin_keystone_update'
            'identity:check_endpoint_in_project': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_endpoints_for_project': 'rule:admin_required or role:admin_keystone_read'
            'identity:remove_endpoint_from_project': 'rule:admin_only or role:admin_keystone_delete'
            'identity:create_endpoint_group': 'rule:admin_only or role:admin_keystone_create'
            'identity:list_endpoint_groups': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_endpoint_group': 'rule:admin_required or role:admin_keystone_read'
            'identity:update_endpoint_group': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_endpoint_group': 'rule:admin_only or role:admin_keystone_delete'
            'identity:list_projects_associated_with_endpoint_group': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_endpoints_associated_with_endpoint_group': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_endpoint_group_in_project': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_endpoint_groups_for_project': 'rule:admin_required or role:admin_keystone_read'
            'identity:add_endpoint_group_to_project': 'rule:admin_only or role:admin_keystone_update'
            'identity:remove_endpoint_group_from_project': 'rule:admin_only or role:admin_keystone_update'
            'identity:create_identity_provider': 'rule:admin_only or role:admin_keystone_create'
            'identity:list_identity_providers': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_identity_provider': 'rule:admin_required or role:admin_keystone_read'
            'identity:update_identity_provider': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_identity_provider': 'rule:admin_only or role:admin_keystone_delete'
            'identity:create_protocol': 'rule:admin_only or role:admin_keystone_create'
            'identity:update_protocol': 'rule:admin_only or role:admin_keystone_update'
            'identity:get_protocol': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_protocols': 'rule:admin_required or role:admin_keystone_read'
            'identity:delete_protocol': 'rule:admin_only or role:admin_keystone_delete'
            'identity:create_mapping': 'rule:admin_only or role:admin_keystone_create'
            'identity:get_mapping': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_mappings': 'rule:admin_required or role:admin_keystone_read'
            'identity:delete_mapping': 'rule:admin_only or role:admin_keystone_delete'
            'identity:update_mapping': 'rule:admin_only or role:admin_keystone_update'
            'identity:create_service_provider': 'rule:admin_only or role:admin_keystone_create'
            'identity:list_service_providers': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_service_provider': 'rule:admin_required or role:admin_keystone_read'
            'identity:update_service_provider': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_service_provider': 'rule:admin_only or role:admin_keystone_delete'
            'identity:get_auth_catalog': 'rule:tenant_read or role:tenant_keystone_read'
            'identity:get_auth_projects': ''
            'identity:get_auth_domains': ''
            'identity:list_projects_for_user': ''
            'identity:list_domains_for_user': ''
            'identity:list_projects_for_groups': ''
            'identity:list_domains_for_groups': ''
            'identity:list_revoke_events': 'rule:tenant_read or role:tenant_keystone_read'
            'identity:create_policy_association_for_endpoint': 'rule:admin_only or role:admin_keystone_create'
            'identity:check_policy_association_for_endpoint': 'rule:admin_required or role:admin_keystone_read'
            'identity:delete_policy_association_for_endpoint': 'rule:admin_only or role:admin_keystone_delete'
            'identity:create_policy_association_for_service': 'rule:admin_only or role:admin_keystone_create'
            'identity:check_policy_association_for_service': 'rule:admin_required or role:admin_keystone_read'
            'identity:delete_policy_association_for_service': 'rule:admin_only or role:admin_keystone_delete'
            'identity:create_policy_association_for_region_and_service': 'rule:admin_required or role:admin_keystone_create'
            'identity:check_policy_association_for_region_and_service': 'rule:admin_required or role:admin_keystone_read'
            'identity:delete_policy_association_for_region_and_service': 'rule:admin_only or role:admin_keystone_delete'
            'identity:get_policy_for_endpoint': 'rule:admin_required or role:admin_keystone_read'
            'identity:list_endpoints_for_policy': 'rule:admin_required or role:admin_keystone_read'
            'identity:create_domain_config': 'rule:admin_create or role:admin_keystone_create'
            'identity:get_domain_config': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_security_compliance_domain_config': 'rule:admin_required or role:admin_keystone_read'
            'identity:update_domain_config': 'rule:admin_only or role:admin_keystone_update'
            'identity:delete_domain_config': 'rule:admin_only or role:admin_keystone_delete'
            'identity:get_domain_config_default': 'rule:admin_required or role:admin_keystone_read'
            'identity:add_role_to_user': 'rule:admin_create or role:admin_keystone_update'
            'identity:remove_role_from_user': 'rule:admin_create or role:admin_keystone_delete'
            'identity:get_user_roles': 'rule:admin_required or role:admin_keystone_read'
            'identity:get_projects_for_token': ''
            'identity:create_project_tag': 'rule:admin_create'
            'identity:delete_project_tag': 'rule:admin_only'
            'identity:get_project_tag': 'rule:admin_required'
            'identity:list_project_tags': 'rule:admin_required'
            'identity:delete_project_tags': 'rule:admin_only'
            'identity:update_project_tags': 'rule:admin_create'
            'identity:get_application_credential': 'rule:owner'
            'identity:list_application_credentials': 'rule:admin_keystone_read or rule:owner'
            'identity:create_application_credential': 'user_id:%(user_id)s'
            'identity:delete_application_credential': 'rule:admin_only or role:admin_keystone_delete or rule:owner'
          neutron:
            'tenant_neutron_create': 'role:tenant_neutron_create'
            'tenant_neutron_update': 'role:tenant_neutron_update'
            'tenant_neutron_read': 'role:tenant_neutron_read'
            'tenant_neutron_delete': 'role:tenant_neutron_delete'
            'admin_neutron_create': 'role:admin_neutron_create'
            'admin_neutron_update': 'role:admin_neutron_update'
            'admin_neutron_read': 'role:admin_neutron_read'
            'admin_neutron_delete': 'role:admin_neutron_delete'
            'rapid_group': 'role:tenant_neutron_create and role:tenant_neutron_update and role:tenant_neutron_read and role:tenant_neutron_delete and role:admin_neutron_create and role:admin_neutron_update and role:admin_neutron_read and role:admin_neutron_delete'
            'context_is_admin': 'role:admin or role:admin_support or role:admin_viewer'
            'owner': 'tenant_id:%(tenant_id)s'
            'admin_or_owner': 'role:admin or (tenant_id:%(tenant_id)s and (role:_member_ or role:sriov_member or role:snapshot_member))'
            'context_is_advsvc': 'role:advsvc'
            'admin_or_network_owner': 'rule:context_is_admin or tenant_id:%(network:tenant_id)s'
            'admin_owner_or_network_owner': 'rule:owner or rule:admin_or_network_owner'
            'admin_only': 'role:admin'
            'admin_tap': 'role:admin_tap or rule:admin_only'
            'shared': 'field:networks:shared=True'
            'shared_firewalls': 'field:firewalls:shared=True'
            'shared_firewall_policies': 'field:firewall_policies:shared=True'
            'shared_subnetpools': 'field:subnetpools:shared=True'
            'shared_address_scopes': 'field:address_scopes:shared=True'
            'external': 'field:networks:router:external=True'
            'external_and_public': 'rule:external'
            'admin_create': 'role:admin or role:admin_support'
            'admin_read': 'role:admin or role:admin_support or role:admin_viewer'
            'admin_update': 'role:admin'
            'admin_delete': 'role:admin'
            'tenant_create': 'rule:admin_create or (tenant_id:%(tenant_id)s and (role:support_member or role:sriov_member or role:_member_ or role:snapshot_member))'
            'tenant_create_network': 'rule:admin_create or (tenant_id:%(network:tenant_id)s and (role:support_member or role:sriov_member or role:_member_ or role:snapshot_member))'
            'tenant_read': 'rule:admin_read or (tenant_id:%(tenant_id)s and (role:viewer or role:_member_ or role:sriov_member or role:snapshot_member or role:support_member))'
            'tenant_update': 'rule:admin_update or (tenant_id:%(tenant_id)s and (role:_member_ or role:sriov_member or role:snapshot_member))'
            'tenant_update_network': 'rule:admin_update or (tenant_id:%(network:tenant_id)s and (role:_member_ or role:sriov_member or role:snapshot_member))'
            'tenant_update_security_group': 'rule:admin_create or (tenant_id:%(tenant_id)s and (role:_member_ or role:sriov_member or role:support_member or role:snapshot_member))'
            'tenant_delete': 'rule:admin_delete or (tenant_id:%(tenant_id)s and (role:_member_ or role:sriov_member or role:snapshot_member))'
            'tenant_delete_network': 'rule:admin_delete or (tenant_id:%(network:tenant_id)s and (role:_member_ or role:sriov_member or role:snapshot_member))'
            'tenant_admin_or_network_owner': 'rule:admin_owner_or_network_owner and (not role:support_member) and (not role:viewer) and (not role:admin_support) and (not role:admin_viewer) and (not role:admin_orm) and (not rule:rapid_group)'
            'sriov_create': 'rule:admin_create or role:sriov_member'
            'sriov_read': 'rule:admin_read or role:sriov_member'
            'sriov_delete': 'rule:tenant_delete or role:sriov_member'
            'floating_ip_admin': 'role:admin or (role:admin_neutron_create and role:admin_neutron_update and role:admin_neutron_read and role:admin_neutron_delete)'
            'default': 'rule:admin_or_owner'
            'create_subnet': 'rule:tenant_create_network or rule:tenant_neutron_create'
            'get_subnet': 'rule:tenant_read or rule:shared or rule:tenant_neutron_read'
            'update_subnet': 'rule:tenant_update_network or rule:tenant_neutron_update'
            'delete_subnet': 'rule:tenant_delete_network or rule:tenant_neutron_delete'
            'create_subnetpool': 'rule:tenant_create or rule:tenant_neutron_create'
            'create_subnetpool:shared': 'rule:admin_create or rule:admin_neutron_create'
            'get_subnetpool': 'rule:tenant_read or rule:shared_subnetpools or rule:tenant_neutron_read'
            'update_subnetpool': 'rule:tenant_update or rule:tenant_neutron_update'
            'delete_subnetpool': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'create_subnetpool:is_default': 'rule:admin_only or rule:admin_neutron_create'
            'update_subnetpool:is_default': 'rule:admin_only or rule:admin_neutron_update'
            'create_subnet:segment_id': 'rule:admin_only or rule:admin_neutron_create'
            'create_subnet:service_types': 'rule:admin_only or rule:admin_neutron_create'
            'get_subnet:segment_id': 'rule:admin_only or rule:admin_neutron_read'
            'update_subnet:service_types': 'rule:admin_only or rule:admin_neutron_update'
            'create_address_scope': 'rule:tenant_create or rule:tenant_neutron_create'
            'create_address_scope:shared': 'rule:admin_only or rule:admin_neutron_create'
            'get_address_scope': 'rule:tenant_read or rule:shared_address_scopes or rule:tenant_neutron_read'
            'update_address_scope': 'rule:tenant_update or rule:tenant_neutron_update'
            'update_address_scope:shared': 'rule:admin_only or rule:admin_neutron_update'
            'delete_address_scope': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'get_network': 'rule:tenant_read or rule:shared or rule:external_and_public or rule:context_is_advsvc or rule:tenant_neutron_read'
            'get_network:router:external': 'rule:tenant_read or rule:tenant_neutron_read'
            'get_network:segments': 'rule:sriov_read or rule:admin_neutron_read'
            'get_network:provider:network_type': 'rule:sriov_read or rule:admin_neutron_read'
            'get_network:provider:physical_network': 'rule:sriov_read or rule:admin_neutron_read'
            'get_network:provider:segmentation_id': 'rule:sriov_read or rule:admin_neutron_read'
            'get_network:queue_id': 'rule:sriov_read or rule:admin_neutron_read'
            'get_network_ip_availabilities': 'rule:admin_only or rule:admin_neutron_read'
            'get_network_ip_availability': 'rule:admin_only or rule:admin_neutron_read'
            'create_network': 'rule:tenant_create or rule:tenant_neutron_create'
            'create_network:shared': 'rule:admin_create or rule:admin_neutron_create'
            'create_network:router:external': 'rule:admin_create or rule:admin_neutron_create'
            'create_network:router:private': 'rule:admin_only or rule:admin_neutron_create'
            'create_network:segments': 'rule:admin_create or rule:admin_neutron_create'
            'create_network:provider:network_type': 'rule:admin_create or rule:admin_neutron_create'
            'create_network:provider:physical_network': 'rule:admin_create or rule:admin_neutron_create'
            'create_network:provider:segmentation_id': 'rule:admin_create or rule:admin_neutron_create'
            'create_network:is_default': 'rule:admin_only or rule:admin_neutron_create'
            'update_network': 'rule:tenant_update or rule:tenant_neutron_update'
            'update_network:segments': 'rule:admin_update or rule:admin_neutron_update'
            'update_network:shared': 'rule:admin_update or rule:admin_neutron_update'
            'update_network:provider:network_type': 'rule:admin_update or rule:admin_neutron_update'
            'update_network:provider:physical_network': 'rule:admin_update or rule:admin_neutron_update'
            'update_network:provider:segmentation_id': 'rule:admin_update or rule:admin_neutron_update'
            'update_network:router:external': 'rule:admin_update or rule:admin_neutron_update'
            'delete_network': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'delete_network:provider:physical_network': 'role:admin or role:sriov_member or rule:admin_neutron_delete'
            'delete_network:router:private': 'rule:tenant_delete or rule:admin_neutron_delete'
            'delete_network:provider:network_type': 'role:admin or role:sriov_member or rule:admin_neutron_delete'
            'delete_network:provider:segmentation_id': 'role:admin or role:sriov_member or rule:admin_neutron_delete'
            'create_segment': 'rule:admin_only or rule:admin_neutron_create'
            'get_segment': 'rule:admin_only or rule:admin_neutron_read'
            'update_segment': 'rule:admin_only or rule:admin_neutron_update'
            'delete_segment': 'rule:admin_only or rule:admin_neutron_delete'
            'network_device': 'field:port:device_owner=~^network: or rule:tenant_neutron_read'
            'create_security_group': 'rule:tenant_create or rule:tenant_neutron_create'
            'update_security_group': 'rule:tenant_update_security_group or rule:tenant_neutron_update'
            'delete_security_group': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'get_security_group': 'rule:tenant_read or rule:tenant_neutron_read'
            'get_security_groups': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_security_group_rule': 'rule:tenant_create or rule:tenant_neutron_create'
            'delete_security_group_rule': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'get_security_group_rule': 'rule:tenant_read or rule:tenant_neutron_read'
            'get_security_group_rules': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_port': 'rule:tenant_create or rule:context_is_advsvc or rule:tenant_neutron_create'
            'create_port:device_owner': 'rule:tenant_create_network or not rule:network_device or rule:context_is_advsvc or rule:tenant_neutron_create'
            'create_port:mac_address': 'rule:tenant_create_network or rule:context_is_advsvc or rule:tenant_neutron_create'
            'create_port:fixed_ips': 'rule:tenant_create_network or rule:context_is_advsvc or rule:tenant_neutron_create'
            'create_port:fixed_ips:ip_address': 'rule:tenant_create_network or rule:context_is_advsvc or rule:tenant_neutron_create'
            'create_port:port_security_enabled': 'rule:tenant_create_network or rule:context_is_advsvc or rule:tenant_neutron_create'
            'create_port:binding:host_id': 'rule:admin_create or rule:admin_neutron_create'
            'create_port:binding:profile': 'rule:sriov_create or rule:tenant_neutron_create'
            'create_port:binding:vnic_type': 'rule:sriov_create or rule:tenant_neutron_create'
            'create_port:mac_learning_enabled': 'rule:tenant_create_network or rule:context_is_advsvc or rule:tenant_neutron_create'
            'create_port:allowed_address_pairs': 'rule:tenant_create_network or rule:tenant_neutron_create'
            'get_port': 'rule:context_is_advsvc or rule:tenant_read or rule:tenant_admin_or_network_owner or rule:tenant_neutron_read'
            'get_port:queue_id': 'rule:sriov_read or rule:tenant_neutron_read'
            'get_port:binding:vif_type': 'rule:sriov_read or rule:tenant_neutron_read'
            'get_port:binding:vif_details': 'rule:sriov_read or rule:tenant_neutron_read'
            'get_port:binding:host_id': 'rule:sriov_read or rule:tenant_neutron_read'
            'get_port:binding:profile': 'rule:sriov_read or rule:tenant_neutron_read'
            'update_port': 'rule:tenant_update or rule:context_is_advsvc or rule:tenant_neutron_update'
            'update_port:device_owner': 'rule:tenant_update_network or not rule:network_device or rule:context_is_advsvc or rule:tenant_neutron_update'
            'update_port:mac_address': 'rule:admin_update or rule:context_is_advsvc or rule:admin_neutron_update'
            'update_port:fixed_ips': 'rule:tenant_update_network or rule:context_is_advsvc or rule:tenant_neutron_update'
            'update_port:fixed_ips:ip_address': 'rule:tenant_update_network or rule:context_is_advsvc or rule:tenant_neutron_update'
            'update_port:port_security_enabled': 'rule:tenant_update_network or rule:context_is_advsvc or rule:tenant_neutron_update'
            'update_port:binding:host_id': 'rule:admin_update or rule:admin_neutron_update'
            'update_port:binding:profile': 'rule:admin_update or rule:admin_neutron_update'
            'update_port:binding:vnic_type': 'rule:tenant_update_network or rule:context_is_advsvc or rule:admin_neutron_update'
            'update_port:mac_learning_enabled': 'rule:tenant_update_network or rule:context_is_advsvc or rule:tenant_neutron_update'
            'update_port:allowed_address_pairs': 'rule:tenant_update_network or rule:tenant_neutron_update'
            'delete_port': 'rule:context_is_advsvc or rule:sriov_delete or rule:tenant_admin_or_network_owner or rule:tenant_neutron_delete'
            'delete_port:binding:vif_details': 'rule:sriov_delete or rule:context_is_advsvc or rule:tenant_neutron_delete'
            'delete_port:binding:vif_type': 'rule:sriov_delete or rule:context_is_advsvc or rule:tenant_neutron_delete'
            'delete_port:mac_address': 'rule:sriov_delete or rule:context_is_advsvc or rule:tenant_neutron_delete'
            'delete_port:binding:profile': 'rule:sriov_delete or rule:context_is_advsvc or rule:tenant_neutron_delete'
            'delete_port:fixed_ips': 'rule:sriov_delete or rule:context_is_advsvc or rule:tenant_neutron_delete'
            'delete_port:binding:host_id': 'rule:sriov_delete or rule:context_is_advsvc or rule:admin_neutron_delete'
            'delete_port:allowed_address_pairs': 'rule:tenant_delete or rule:context_is_advsvc or rule:tenant_neutron_delete'
            'delete_port:port_security_enabled': 'rule:sriov_delete or rule:context_is_advsvc or rule:tenant_neutron_delete'
            'delete_port:device_owner': 'rule:sriov_delete or rule:context_is_advsvc or rule:tenant_neutron_delete'
            'delete_port:binding:vnic_type': 'rule:sriov_delete or rule:context_is_advsvc or rule:tenant_neutron_delete'
            'get_router:ha': 'rule:admin_read or rule:admin_neutron_read'
            'create_router': 'rule:tenant_create or rule:tenant_neutron_create'
            'create_router:external_gateway_info:enable_snat': 'rule:admin_only or rule:admin_neutron_create'
            'create_router:external_gateway_info': 'rule:tenant_create or rule:tenant_neutron_create'
            'create_router:external_gateway_info:network_id': 'rule:tenant_create or rule:tenant_neutron_create'
            'create_router:distributed': 'rule:admin_create or rule:admin_neutron_create'
            'create_router:ha': 'rule:admin_create or rule:admin_neutron_create'
            'get_router': 'rule:tenant_read or rule:tenant_neutron_read'
            'get_router:distributed': 'rule:admin_read or rule:admin_neutron_read'
            'update_router': 'rule:tenant_update or rule:tenant_neutron_update'
            'update_router:external_gateway_info': 'rule:tenant_update or rule:tenant_neutron_update'
            'update_router:external_gateway_info:network_id': 'rule:tenant_update or rule:tenant_neutron_update'
            'update_router:external_gateway_info:enable_snat': 'rule:admin_update or rule:admin_neutron_update'
            'update_router:distributed': 'rule:admin_update or rule:admin_neutron_update'
            'update_router:ha': 'rule:admin_update or rule:admin_neutron_update'
            'delete_router': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'delete_router:distributed': 'rule:tenant_delete or rule:admin_neutron_delete'
            'delete_router:ha': 'rule:tenant_delete or rule:admin_neutron_delete'
            'add_router_interface': 'rule:tenant_create or rule:tenant_neutron_create'
            'add_router_interface:ha': 'rule:tenant_create or rule:tenant_neutron_create'
            'add_router_interface:external_gateway_info': 'rule:tenant_create or rule:tenant_neutron_create'
            'add_router_interface:external_gateway_info:network_id': 'rule:tenant_create or rule:tenant_neutron_create'
            'add_router_interface:external_gateway_info:enable_snat': 'rule:tenant_create or rule:tenant_neutron_create'
            'add_router_interface:external_gateway_info:external_fixed_ips': 'rule:tenant_create or rule:tenant_neutron_create'
            'add_router_interface:distributed': 'rule:tenant_create or rule:tenant_neutron_create'
            'add_router_interface:flavor_id': 'rule:tenant_create or rule:tenant_neutron_create'
            'remove_router_interface': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'remove_router_interface:distributed': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'remove_router_interface:ha': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'remove_router_interface:flavor_id': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'create_router:external_gateway_info:external_fixed_ips': 'rule:admin_only or rule:admin_neutron_create'
            'update_router:external_gateway_info:external_fixed_ips': 'rule:admin_update or rule:admin_neutron_update'
            'create_pool': 'rule:tenant_create or rule:tenant_neutron_create'
            'update_pool': 'rule:tenant_update or rule:tenant_neutron_update'
            'delete_pool': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'get_pool': 'rule:tenant_read or rule:tenant_neutron_read'
            'stats': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_vip': 'rule:tenant_create or rule:tenant_neutron_create'
            'update_vip': 'rule:tenant_update or rule:tenant_neutron_update'
            'delete_vip': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'get_vip': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_member': 'rule:tenant_create or rule:tenant_neutron_create'
            'update_member': 'rule:tenant_update or rule:tenant_neutron_update'
            'delete_member': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'get_member': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_health_monitor': 'rule:tenant_create or rule:tenant_neutron_create'
            'update_health_monitor': 'rule:tenant_update or rule:tenant_neutron_update'
            'delete_health_monitor': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'get_health_monitor': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_pool_health_monitor': 'rule:tenant_create or rule:tenant_neutron_create'
            'delete_pool_health_monitor': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'create_firewall': 'rule:tenant_create or rule:tenant_neutron_create'
            'get_firewall': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_firewall:shared': 'rule:admin_create or rule:admin_neutron_create'
            'get_firewall:shared': 'rule:admin_read or rule:admin_neutron_read'
            'update_firewall': 'rule:tenant_update or rule:tenant_neutron_update'
            'update_firewall:shared': 'rule:admin_update or rule:admin_neutron_update'
            'delete_firewall': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'delete_firewall:shared': 'rule:admin_delete or rule:admin_neutron_delete'
            'create_firewall_policy': 'rule:tenant_create or rule:tenant_neutron_create'
            'get_firewall_policy': 'rule:tenant_read or rule:shared_firewall_policies or rule:tenant_neutron_read'
            'create_firewall_policy:shared': 'rule:admin_create or rule:admin_neutron_create'
            'update_firewall_policy': 'rule:tenant_update or rule:tenant_neutron_update'
            'delete_firewall_policy': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'create_firewall_rule': 'rule:tenant_create or rule:tenant_neutron_create'
            'create_firewall_rule:shared': 'rule:admin_create or rule:admin_neutron_create'
            'get_firewall_rule': 'rule:tenant_read or rule:shared_firewalls or rule:tenant_neutron_read'
            'update_firewall_rule': 'rule:tenant_update or rule:tenant_neutron_update'
            'delete_firewall_rule': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'insert_rule': 'rule:admin_or_owner'
            'remove_rule': 'rule:admin_or_owner'
            'create_qos_queue': 'rule:admin_create or rule:admin_neutron_create'
            'get_qos_queue': 'rule:admin_read or rule:admin_neutron_read'
            'update_agent': 'rule:admin_update or rule:admin_neutron_update'
            'delete_agent': 'rule:admin_delete or rule:admin_neutron_delete'
            'get_agent': 'rule:admin_read or rule:admin_neutron_read'
            'create_dhcp-network': 'rule:admin_create or rule:admin_neutron_create'
            'delete_dhcp-network': 'rule:admin_delete or rule:admin_neutron_delete'
            'get_dhcp-networks': 'rule:admin_read or rule:admin_neutron_read'
            'create_l3-router': 'rule:admin_create or rule:admin_neutron_create'
            'delete_l3-router': 'rule:admin_delete or rule:admin_neutron_delete'
            'get_l3-routers': 'rule:admin_read or rule:admin_neutron_read'
            'get_dhcp-agents': 'rule:admin_read or rule:admin_neutron_read'
            'get_l3-agents': 'rule:admin_read or rule:admin_neutron_read'
            'get_loadbalancer-agent': 'rule:admin_read or rule:admin_neutron_read'
            'get_loadbalancer-pools': 'rule:admin_read or rule:admin_neutron_read'
            'get_agent-loadbalancers': 'rule:admin_read or rule:admin_neutron_read'
            'get_loadbalancer-hosting-agent': 'rule:admin_read or rule:admin_neutron_read'
            'create_floatingip': '!'
            'create_floatingip:floating_ip_address': '!'
            'update_floatingip': '!'
            'delete_floatingip': '!'
            'delete_floatingip:floating_ip_address': '!'
            'get_floatingip': '!'
            'create_network_profile': 'rule:admin_create or rule:admin_neutron_create'
            'update_network_profile': 'rule:admin_update or rule:admin_neutron_update'
            'delete_network_profile': 'rule:admin_delete or rule:admin_neutron_delete'
            'get_network_profiles': 'rule:admin_read or rule:admin_neutron_read'
            'get_network_profile': 'rule:tenant_read or rule:tenant_neutron_read'
            'update_policy_profiles': 'rule:admin_update or rule:admin_neutron_update'
            'get_policy_profiles': 'rule:tenant_read or rule:tenant_neutron_read'
            'get_policy_profile': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_metering_label': 'rule:admin_create or rule:admin_neutron_create'
            'delete_metering_label': 'rule:admin_delete or rule:admin_neutron_delete'
            'get_metering_label': 'rule:admin_read or rule:admin_neutron_read'
            'create_metering_label_rule': 'rule:admin_create or rule:admin_neutron_create'
            'delete_metering_label_rule': 'rule:admin_delete or rule:admin_neutron_delete'
            'get_metering_label_rule': 'rule:admin_read or rule:admin_neutron_read'
            'get_service_provider': 'rule:tenant_read or rule:tenant_neutron_read'
            'get_lsn': 'rule:admin_read or rule:admin_neutron_read'
            'create_lsn': 'rule:admin_create or rule:admin_neutron_create'
            'create_flavor': 'rule:admin_only or rule:admin_neutron_create'
            'update_flavor': 'rule:admin_only or rule:admin_neutron_update'
            'delete_flavor': 'rule:admin_only or rule:admin_neutron_delete'
            'get_flavors': 'rule:tenant_read or rule:tenant_neutron_read'
            'get_flavor': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_service_profile': 'rule:admin_only or rule:admin_neutron_create'
            'update_service_profile': 'rule:admin_only or rule:admin_neutron_update'
            'delete_service_profile': 'rule:admin_only or rule:admin_neutron_delete'
            'get_service_profiles': 'rule:admin_only or rule:admin_neutron_read'
            'get_service_profile': 'rule:admin_only or rule:admin_neutron_read'
            'get_policy': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_policy': 'rule:admin_only or rule:admin_neutron_create'
            'update_policy': 'rule:admin_only or rule:admin_neutron_update'
            'delete_policy': 'rule:admin_only or rule:admin_neutron_delete'
            'get_policy_bandwidth_limit_rule': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_policy_bandwidth_limit_rule': 'rule:admin_only or rule:admin_neutron_create'
            'delete_policy_bandwidth_limit_rule': 'rule:admin_only or rule:admin_neutron_delete'
            'update_policy_bandwidth_limit_rule': 'rule:admin_only or rule:admin_neutron_update'
            'get_policy_dscp_marking_rule': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_policy_dscp_marking_rule': 'rule:admin_only or rule:admin_neutron_create'
            'delete_policy_dscp_marking_rule': 'rule:admin_only or rule:admin_neutron_delete'
            'update_policy_dscp_marking_rule': 'rule:admin_only or rule:admin_neutron_update'
            'get_rule_type': 'rule:tenant_read or rule:tenant_neutron_read'
            'get_policy_minimum_bandwidth_rule': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_policy_minimum_bandwidth_rule': 'rule:admin_only or rule:admin_neutron_create'
            'delete_policy_minimum_bandwidth_rule': 'rule:admin_only or rule:admin_neutron_delete'
            'update_policy_minimum_bandwidth_rule': 'rule:admin_only or rule:admin_neutron_update'
            'restrict_wildcard': '(not field:rbac_policy:target_tenant=*) or rule:admin_only'
            'create_rbac_policy': 'rule:tenant_create or rule:tenant_neutron_create'
            'create_rbac_policy:target_tenant': 'rule:restrict_wildcard or rule:tenant_neutron_create'
            'update_rbac_policy': 'rule:tenant_update or rule:tenant_neutron_update'
            'update_rbac_policy:target_tenant': 'rule:restrict_wildcard and rule:tenant_update or rule:tenant_neutron_update'
            'get_rbac_policy': 'rule:tenant_read or rule:tenant_neutron_read'
            'delete_rbac_policy': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'create_flavor_service_profile': 'rule:admin_only or rule:admin_neutron_create'
            'delete_flavor_service_profile': 'rule:admin_only or rule:admin_neutron_delete'
            'get_flavor_service_profile': 'rule:tenant_read or rule:tenant_neutron_read'
            'get_auto_allocated_topology': 'rule:tenant_read or rule:tenant_neutron_read'
            'create_trunk': 'rule:tenant_create or rule:tenant_neutron_create'
            'get_trunk': 'rule:tenant_read or rule:tenant_neutron_read'
            'delete_trunk': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'get_subports': 'rule:tenant_read or rule:tenant_neutron_read'
            'add_subports': 'rule:tenant_create or rule:tenant_neutron_create'
            'remove_subports': 'rule:tenant_delete or rule:tenant_neutron_delete'
            'create_tap_service': 'rule:admin_tap'
            'delete_tap_service': 'rule:admin_tap'
            'update_tap_service': 'rule:admin_tap'
            'get_tap_services': 'rule:admin_tap or role:admin_viewer'
            'get_tap_service': 'rule:admin_tap or role:admin_viewer'
            'create_tap_flow': 'rule:admin_tap'
            'delete_tap_flow': 'rule:admin_tap'
            'update_tap_flow': 'rule:admin_tap'
            'get_tap_flow': 'rule:admin_tap or role:admin_viewer'
            'get_tap_flows': 'rule:admin_tap or role:admin_viewer'

          nova:
            'context_is_admin': 'role:admin or role:admin_support or role:admin_viewer'
            'admin_or_owner': 'role:admin or project_id:%(project_id)s'
            'default': 'role:admin'
            'admin_api': 'is_admin:True'
            'admin_create': 'role:admin or role:admin_support'
            'admin_read': 'role:admin or role:admin_support or role:admin_viewer'
            'admin_update': 'role:admin'
            'admin_delete': 'role:admin'
            'admin_snapshot': 'role:admin'
            'tenant_create': 'role:snapshot_member or role:_member_ or role:sriov_member or role:support_member or rule:admin_create'
            'tenant_snapshot': 'role:snapshot_member or rule:admin_snapshot'
            'tenant_read': 'role:snapshot_member or role:_member_ or role:sriov_member or role:support_member or role:viewer or rule:admin_read'
            'tenant_update': 'role:snapshot_member or role:_member_ or role:sriov_member or rule:admin_update'
            'tenant_delete': 'role:snapshot_member or role:_member_ or role:sriov_member or rule:admin_delete'
            'cells_scheduler_filter:TargetCellFilter': 'role:admin'
            'not_supported_in_nc': '!'
            'compute:create': 'rule:tenant_create or role:tenant_nova_create'
            'compute:create:attach_network': 'rule:tenant_create or role:tenant_nova_create'
            'compute:create:attach_volume': 'rule:tenant_create or role:tenant_nova_create'
            'compute:create:forced_host': 'rule:admin_update or role:admin_nova_update'
            'compute:get': 'rule:tenant_read or role:tenant_nova_read'
            'compute:get_all': 'rule:tenant_read or role:tenant_nova_read'
            'compute:get_all_tenants': 'rule:admin_read or role:admin_nova_read'
            'compute:start': 'rule:tenant_create or role:tenant_nova_create'
            'compute:stop': 'rule:tenant_update or role:tenant_nova_update'
            'compute:unlock_override': 'rule:admin_update or role:admin_nova_update'
            'compute:get_diagnostics': 'rule:admin_read or role:admin_nova_read'
            'compute:get_instance_diagnostics': 'rule:admin_read or role:admin_nova_read'
            'compute:get_console_output': 'rule:tenant_read or role:tenant_nova_read'
            'compute:get_vnc_console': 'rule:tenant_read or role:tenant_nova_read'
            'compute:get_spice_console': 'rule:tenant_read or role:tenant_nova_read'
            'compute:get_rdp_console': 'rule:tenant_read or role:tenant_nova_read'
            'compute:get_serial_console': 'rule:tenant_read or role:tenant_nova_read'
            'compute:get_mks_console': 'rule:tenant_read or role:tenant_nova_read'
            'compute:reset_network': 'rule:tenant_update or role:tenant_nova_update'
            'compute:inject_network_info': 'rule:tenant_update or role:tenant_nova_update'
            'compute:add_fixed_ip': 'rule:tenant_create or role:tenant_nova_create'
            'compute:remove_fixed_ip': 'rule:tenant_delete or role:tenant_nova_delete'
            'compute:redefine': 'rule:tenant_update or role:tenant_nova_update'
            'compute:snapshot': 'rule:tenant_snapshot or role:tenant_nova_create'
            'compute:snapshot_volume_backed': 'rule:tenant_snapshot or role:tenant_nova_create'
            'compute:backup': 'rule:tenant_snapshot or role:tenant_nova_create'
            'compute:security_groups:add_to_instance': 'rule:tenant_update or role:tenant_nova_update'
            'compute:security_groups:remove_from_instance': 'rule:tenant_update or role:tenant_nova_update'
            'compute:restore': 'rule:tenant_update or role:tenant_nova_update'
            'compute:shelve': 'rule:tenant_snapshot or role:tenant_nova_create'
            'compute:shelve_offload': 'rule:tenant_update or role:tenant_nova_update'
            'compute:unshelve': 'rule:tenant_update or role:tenant_nova_update'
            'compute:resize': 'rule:tenant_update or role:tenant_nova_update'
            'compute:confirm_resize': 'rule:tenant_update or role:tenant_nova_update'
            'compute:revert_resize': 'rule:tenant_update or role:tenant_nova_update'
            'compute:rebuild': 'rule:tenant_update or role:tenant_nova_update'
            'compute:reboot': 'rule:tenant_update or role:tenant_nova_update'
            'compute:update': 'rule:tenant_update or role:tenant_nova_update'
            'compute:lock': 'rule:tenant_update or role:tenant_nova_update'
            'compute:unlock': 'rule:tenant_update or role:tenant_nova_update'
            'compute:delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'compute:soft_delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'compute:force_delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'compute:attach_volume': 'rule:tenant_update or role:tenant_nova_update'
            'compute:detach_volume': 'rule:tenant_update or role:tenant_nova_update'
            'compute:swap_volume': 'rule:admin_update or role:admin_nova_update'
            'compute:attach_interface': 'rule:tenant_update or role:tenant_nova_update'
            'compute:detach_interface': 'rule:tenant_update or role:tenant_nova_update'
            'compute:set_admin_password': 'rule:tenant_create or role:tenant_nova_create'
            'compute:rescue': 'rule:tenant_update or role:tenant_nova_update'
            'compute:unrescue': 'rule:tenant_update or role:tenant_nova_update'
            'compute:suspend': 'rule:tenant_update or role:tenant_nova_update'
            'compute:resume': 'rule:tenant_update or role:tenant_nova_update'
            'compute:pause': 'rule:tenant_update or role:tenant_nova_update'
            'compute:unpause': 'rule:tenant_update or role:tenant_nova_update'
            'compute:volume_snapshot_create': 'rule:tenant_snapshot or role:tenant_nova_create'
            'compute:volume_snapshot_delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'compute:get_instance_metadata': 'rule:tenant_read or role:tenant_nova_read'
            'compute:get_all_instance_metadata': 'rule:tenant_read or role:tenant_nova_read'
            'compute:get_all_instance_system_metadata': 'rule:tenant_read or role:tenant_nova_read'
            'compute:update_instance_metadata': 'rule:tenant_update or role:tenant_nova_update'
            'compute:delete_instance_metadata': 'rule:tenant_delete or role:tenant_nova_delete'
            'compute_extension:accounts': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:admin_actions': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:admin_actions:pause': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:admin_actions:unpause': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:admin_actions:suspend': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:admin_actions:resume': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:admin_actions:lock': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:admin_actions:unlock': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:admin_actions:resetNetwork': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:admin_actions:injectNetworkInfo': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:admin_actions:createBackup': 'rule:tenant_snapshot or role:tenant_nova_create'
            'compute_extension:admin_actions:migrateLive': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:admin_actions:resetState': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:admin_actions:migrate': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:aggregates': 'rule:context_is_admin'
            'compute_extension:agents': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:attach_interfaces': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:baremetal_nodes': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:cells': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:cells:create': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:cells:delete': 'rule:admin_delete or role:admin_nova_delete'
            'compute_extension:cells:update': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:cells:sync_instances': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:certificates': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:cloudpipe': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:cloudpipe_update': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:config_drive': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:console_output': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:consoles': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:createserverext': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:deferred_delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'compute_extension:disk_config': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:evacuate': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:redefine': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:extended_server_attributes': 'rule:admin_read or role:admin_nova_read'
            'compute_extension:extended_status': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:extended_availability_zone': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:extended_ips': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:extended_ips_mac': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:extended_vif_net': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:extended_volumes': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:fixed_ips': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:flavor_access': 'rule:admin_read or role:admin_nova_read'
            'compute_extension:flavor_access:addTenantAccess': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:flavor_access:removeTenantAccess': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:flavor_disabled': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:flavor_rxtx': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:flavor_swap': 'rule:tenant_update or role:tenant_nova_update or rule:context_is_admin'
            'compute_extension:flavorextradata': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:flavorextraspecs:index': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:flavorextraspecs:show': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:flavorextraspecs:create': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:flavorextraspecs:update': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:flavorextraspecs:delete': 'rule:admin_delete or role:admin_nova_delete'
            'compute_extension:flavormanage': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:flavordelete': 'rule:admin_delete or role:admin_nova_delete'
            'compute_extension:flavorcreate': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:floating_ip_dns': '!'
            'compute_extension:floating_ip_pools': '!'
            'compute_extension:floating_ips': '!'
            'compute_extension:floating_ips_bulk': '!'
            'compute_extension:fping': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:fping:all_tenants': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:hide_server_addresses': 'is_admin:False'
            'compute_extension:hosts': 'rule:context_is_admin'
            'compute_extension:hypervisors': 'rule:admin_read or role:admin_nova_read'
            'compute_extension:image_size': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:instance_actions': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:instance_actions:events': 'rule:admin_read or role:admin_nova_read'
            'compute_extension:instance_usage_audit_log': 'rule:admin_read or role:admin_nova_read'
            'compute_extension:keypairs': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:keypairs:index': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:keypairs:show': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:keypairs:create': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:keypairs:delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'compute_extension:multinic': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:networks': 'rule:admin_create or role:admin_nova_create'
            'compute_extension:networks:view': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:networks_associate': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:os-tenant-networks': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:quotas:show': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:quotas:update': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:quotas:delete': 'rule:admin_delete or role:admin_nova_delete'
            'compute_extension:quota_classes': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:rescue': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:security_group_default_rules': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:security_groups': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:server_diagnostics': 'rule:admin_read or role:admin_nova_read'
            'compute_extension:server_groups': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:server_password': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:server_usage': 'rule:admin_read or role:admin_nova_read'
            'compute_extension:services': 'rule:context_is_admin'
            'compute_extension:services_update': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:services_delete': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:shelve': 'rule:tenant_snapshot or role:tenant_nova_create'
            'compute_extension:shelveOffload': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:simple_tenant_usage:show': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:simple_tenant_usage:list': 'rule:admin_read or role:admin_nova_read'
            'compute_extension:unshelve': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:users': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:virtual_interfaces': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:virtual_storage_arrays': 'rule:tenant_create or role:tenant_nova_create'
            'compute_extension:volumes': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:volume_attachments:index': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:volume_attachments:show': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:volume_attachments:create': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:volume_attachments:update': 'rule:tenant_update or role:tenant_nova_update'
            'compute_extension:volume_attachments:delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'compute_extension:volumetypes': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:availability_zone:list': 'rule:tenant_read or role:tenant_nova_read'
            'compute_extension:availability_zone:detail': 'rule:admin_read or role:admin_nova_read'
            'compute_extension:used_limits_for_admin': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:migrations:index': 'rule:admin_read or role:admin_nova_read'
            'compute_extension:os-assisted-volume-snapshots:create': 'rule:admin_snapshot or role:admin_nova_create'
            'compute_extension:os-assisted-volume-snapshots:delete': 'rule:admin_delete or role:admin_nova_delete'
            'compute_extension:console_auth_tokens': 'rule:admin_update or role:admin_nova_update'
            'compute_extension:os-server-external-events:create': 'rule:admin_create or role:admin_nova_create'
            'volume:create': 'rule:tenant_create or role:tenant_nova_create'
            'volume:get_all': 'rule:tenant_read or role:tenant_nova_read'
            'volume:get_volume_metadata': 'rule:tenant_read or role:tenant_nova_read'
            'volume:get_snapshot': 'rule:tenant_read or role:tenant_nova_read'
            'volume:get_all_snapshots': 'rule:tenant_read or role:tenant_nova_read'
            'volume_extension:types_manage': 'rule:admin_update or role:admin_nova_update'
            'volume_extension:types_extra_specs': 'rule:admin_update or role:admin_nova_update'
            'volume_extension:volume_admin_actions:reset_status': 'rule:admin_update or role:admin_nova_update'
            'volume_extension:snapshot_admin_actions:reset_status': 'rule:admin_snapshot or role:admin_nova_create'
            'volume_extension:volume_admin_actions:force_delete': 'rule:admin_delete or role:admin_nova_delete'
            'network:get_all': 'rule:not_supported_in_nc'
            'network:get': 'rule:not_supported_in_nc'
            'network:create': 'rule:not_supported_in_nc'
            'network:delete': 'rule:not_supported_in_nc'
            'network:associate': 'rule:not_supported_in_nc'
            'network:disassociate': 'rule:not_supported_in_nc'
            'network:get_vifs_by_instance': 'rule:not_supported_in_nc'
            'network:allocate_for_instance': 'rule:not_supported_in_nc'
            'network:deallocate_for_instance': 'rule:not_supported_in_nc'
            'network:validate_networks': 'rule:not_supported_in_nc'
            'network:get_instance_uuids_by_ip_filter': 'rule:not_supported_in_nc'
            'network:get_instance_id_by_floating_address': '!'
            'network:setup_networks_on_host': 'rule:not_supported_in_nc'
            'network:get_backdoor_port': 'rule:not_supported_in_nc'
            'network:get_floating_ip': '!'
            'network:get_floating_ip_pools': '!'
            'network:get_floating_ip_by_address': '!'
            'network:get_floating_ips_by_project': '!'
            'network:get_floating_ips_by_fixed_address': '!'
            'network:allocate_floating_ip': '!'
            'network:associate_floating_ip': '!'
            'network:disassociate_floating_ip': '!'
            'network:release_floating_ip': '!'
            'network:migrate_instance_start': 'rule:not_supported_in_nc'
            'network:migrate_instance_finish': 'rule:not_supported_in_nc'
            'network:get_fixed_ip': 'rule:not_supported_in_nc'
            'network:get_fixed_ip_by_address': 'rule:not_supported_in_nc'
            'network:add_fixed_ip_to_instance': 'rule:not_supported_in_nc'
            'network:remove_fixed_ip_from_instance': 'rule:not_supported_in_nc'
            'network:add_network_to_project': 'rule:not_supported_in_nc'
            'network:get_instance_nw_info': 'rule:not_supported_in_nc'
            'network:get_dns_domains': 'rule:not_supported_in_nc'
            'network:add_dns_entry': 'rule:not_supported_in_nc'
            'network:modify_dns_entry': 'rule:not_supported_in_nc'
            'network:delete_dns_entry': 'rule:not_supported_in_nc'
            'network:get_dns_entries_by_address': 'rule:not_supported_in_nc'
            'network:get_dns_entries_by_name': 'rule:not_supported_in_nc'
            'network:create_private_dns_domain': 'rule:not_supported_in_nc'
            'network:create_public_dns_domain': 'rule:not_supported_in_nc'
            'network:delete_dns_domain': 'rule:not_supported_in_nc'
            'network:attach_external_network': 'rule:not_supported_in_nc'
            'network:get_vif_by_mac_address': 'rule:not_supported_in_nc'
            'os_compute_api:servers:delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'os_compute_api:servers:update': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:servers:detail': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:servers:index': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:servers:reboot': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:servers:rebuild': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:servers:resize': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:servers:revert_resize': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:servers:create_image': 'rule:tenant_create or role:admin_nova_create'
            'os_compute_api:servers:create_image:allow_volume_backed': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:servers:start': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:servers:stop': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:servers:show': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:servers:show:host_status': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:servers:detail:get_all_tenants': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:servers:index:get_all_tenants': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:servers:confirm_resize': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:servers:create': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:servers:create:attach_network': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:servers:create:attach_volume': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:servers:create:forced_host': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:servers:trigger_crash_dump': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:servers:migrations:force_complete': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:servers:migrations:delete': 'rule:admin_delete or role:admin_nova_delete'
            'os_compute_api:servers:migrations:index': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:servers:migrations:show': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-access-ips:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-access-ips': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-admin-actions': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-admin-actions:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-admin-actions:reset_network': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-admin-actions:inject_network_info': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-admin-actions:reset_state': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-admin-password': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-admin-password:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-aggregates:discoverable': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-aggregates:index': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-aggregates:create': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-aggregates:show': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-aggregates:update': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-aggregates:delete': 'rule:admin_delete or role:admin_nova_delete'
            'os_compute_api:os-aggregates:add_host': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-aggregates:remove_host': 'rule:admin_delete or role:admin_nova_delete'
            'os_compute_api:os-aggregates:set_metadata': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-agents': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-agents:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-attach-interfaces': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-attach-interfaces:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-attach-interfaces:create': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-attach-interfaces:delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'os_compute_api:os-baremetal-nodes': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-baremetal-nodes:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-block-device-mapping-v1': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-block-device-mapping-v1:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-cells': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-cells:create': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-cells:delete': 'rule:admin_delete or role:admin_nova_delete'
            'os_compute_api:os-cells:update': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-cells:sync_instances': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-cells:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-certificates:create': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-certificates:show': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-certificates:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-cloudpipe': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-cloudpipe:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-config-drive': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-config-drive:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-consoles:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-consoles:create': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-consoles:delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'os_compute_api:os-consoles:index': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-consoles:show': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-console-output:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-console-output': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-remote-consoles': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-remote-consoles:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-create-backup:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-create-backup': 'rule:tenant_snapshot or role:tenant_nova_create'
            'os_compute_api:os-deferred-delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'os_compute_api:os-deferred-delete:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-disk-config': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-disk-config:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-evacuate': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-evacuate:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-extended-server-attributes': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-extended-server-attributes:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-extended-status': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-extended-status:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-extended-availability-zone': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-extended-availability-zone:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:extensions:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:extension_info:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-extended-volumes': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-extended-volumes:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-fixed-ips': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-fixed-ips:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-flavor-access': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-flavor-access:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-flavor-access:remove_tenant_access': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-flavor-access:add_tenant_access': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-flavor-rxtx': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-flavor-rxtx:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:flavors': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:flavors:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-flavor-extra-specs:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-flavor-extra-specs:index': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-flavor-extra-specs:show': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-flavor-extra-specs:create': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-flavor-extra-specs:update': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-flavor-extra-specs:delete': 'rule:admin_delete or role:admin_nova_delete'
            'os_compute_api:os-flavor-manage:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-flavor-manage': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-flavor-manage:create': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-flavor-manage:update': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-flavor-manage:delete': 'rule:admin_delete or role:admin_nova_delete'
            'os_compute_api:os-floating-ip-dns': '!'
            'os_compute_api:os-floating-ip-dns:domain:update': '!'
            'os_compute_api:os-floating-ip-dns:discoverable': '!'
            'os_compute_api:os-floating-ip-dns:domain:delete': '!'
            'os_compute_api:os-floating-ip-pools:discoverable': '!'
            'os_compute_api:os-floating-ip-pools': '!'
            'os_compute_api:os-floating-ips': '!'
            'os_compute_api:os-floating-ips:discoverable': '!'
            'os_compute_api:os-floating-ips-bulk:discoverable': '!'
            'os_compute_api:os-floating-ips-bulk': '!'
            'os_compute_api:os-fping': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-fping:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-fping:all_tenants': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-hide-server-addresses': 'is_admin:False'
            'os_compute_api:os-hide-server-addresses:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-hosts': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-hosts:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-hypervisors': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-hypervisors:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:images:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:image-size': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:image-size:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-instance-actions': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-instance-actions:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-instance-actions:events': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-instance-usage-audit-log': 'rule:admin_read or role:admin_nova_read or rule:admin_or_owner'
            'os_compute_api:os-instance-usage-audit-log:discoverable': 'rule:admin_read or role:admin_nova_read or rule:admin_or_owner'
            'os_compute_api:ips:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:ips:index': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:ips:show': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-keypairs:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-keypairs': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-keypairs:index': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-keypairs:show': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-keypairs:create': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-keypairs:delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'os_compute_api:limits:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:limits': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-lock-server:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-lock-server:lock': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-lock-server:unlock': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-lock-server:unlock:unlock_override': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-migrate-server:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-migrate-server:migrate': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-migrate-server:migrate_live': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-multinic': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-multinic:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-networks': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-networks:view': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-networks:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-networks-associate': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-networks-associate:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-pause-server:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-pause-server:pause': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-pause-server:unpause': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-pci:pci_servers': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-pci:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-pci:index': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-pci:detail': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-pci:show': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-personality:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-preserve-ephemeral-rebuild:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-quota-sets:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-quota-sets:show': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-quota-sets:defaults': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-quota-sets:update': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-quota-sets:delete': 'rule:admin_delete or role:admin_nova_delete'
            'os_compute_api:os-quota-sets:detail': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-quota-class-sets': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-quota-class-sets:update': 'rule:admin_update or role:admin_nova_update'
            'os_compute_api:os-quota-class-sets:show': 'rule:admin_read or role:admin_nova_read or quota_class:%(quota_class)s'
            'os_compute_api:os-quota-class-sets:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-redefine': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-redefine:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-rescue': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-rescue:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-scheduler-hints:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-security-group-default-rules:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-security-group-default-rules': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-security-groups': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-security-groups:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-server-diagnostics': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-server-diagnostics:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-server-password': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-server-password:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-server-usage': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-server-usage:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-server-groups': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-server-groups:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-server-tags:index': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-server-tags:show': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-server-tags:update': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-server-tags:update_all': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-server-tags:delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'os_compute_api:os-server-tags:delete_all': 'rule:tenant_delete or role:tenant_nova_delete'
            'os_compute_api:os-services': 'rule:context_is_admin or role:admin_nova_read'
            'os_compute_api:os-services:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:server-metadata:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:server-metadata:index': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:server-metadata:show': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:server-metadata:delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'os_compute_api:server-metadata:create': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:server-metadata:update': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:server-metadata:update_all': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:servers:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-shelve:shelve': 'rule:tenant_snapshot or role:tenant_nova_create'
            'os_compute_api:os-shelve:shelve:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-shelve:shelve_offload': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-simple-tenant-usage:discoverable': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-simple-tenant-usage:show': 'rule:admin_read or role:admin_nova_read or rule:admin_or_owner'
            'os_compute_api:os-simple-tenant-usage:list': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-suspend-server:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-suspend-server:suspend': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-suspend-server:resume': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-tenant-networks': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-tenant-networks:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-shelve:unshelve': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-user-data:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-virtual-interfaces': 'rule:tenant_create or role:tenant_nova_create'
            'os_compute_api:os-virtual-interfaces:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-volumes': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-volumes:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-volumes-attachments:index': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-volumes-attachments:show': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-volumes-attachments:create': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-volumes-attachments:update': 'rule:tenant_update or role:tenant_nova_update'
            'os_compute_api:os-volumes-attachments:delete': 'rule:tenant_delete or role:tenant_nova_delete'
            'os_compute_api:os-volumes-attachments:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-availability-zone:list': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-availability-zone:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-availability-zone:detail': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-used-limits': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-used-limits:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-migrations:index': 'rule:admin_read or role:admin_nova_read'
            'os_compute_api:os-migrations:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-assisted-volume-snapshots:create': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-assisted-volume-snapshots:delete': 'rule:admin_delete or role:admin_nova_delete'
            'os_compute_api:os-assisted-volume-snapshots:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-console-auth-tokens': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-console-auth-tokens:discoverable': 'rule:tenant_read or role:tenant_nova_read'
            'os_compute_api:os-server-external-events:create': 'rule:admin_create or role:admin_nova_create'
            'os_compute_api:os-server-external-events:discoverable': 'rule:tenant_read or role:tenant_nova_read'

  dependencies:
    - os-horizon-htk
...
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: os-horizon-htk
  layeringDefinition:
    abstract: false
    layer: global
  substitutions:
    - src:
        schema: pegleg/SoftwareVersions/v1
        name: software-versions
        path: .charts.osh.horizon-htk
      dest:
        path: .source
  storagePolicy: cleartext
data:
  chart_name: os-horizon-htk
  release: os-horizon-htk
  namespace: os-horizon-htk
  timeout: 600
  wait:
    timeout: 600
  upgrade:
    no_hooks: true
  values: {}
  dependencies: []
...
